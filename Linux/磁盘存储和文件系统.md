lsmod

lsblk -f查看分区

blkid 查看分区和文件系统类型

tune2fs -l /dev/sda1 查看块设备的元数据

## 2.2 文件系统

### **2.2.1 文件系统概念**

文件系统是操作系统用于明确存储设备或分区上的文件的方法和数据结构;即在存储设备上组织文件的方法。操作系统中负责管理和存储文件信息的软件结构称为文件管理系统，简称文件系统。

从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进行保护和检索的系统。具体地说，它负责为用户建立文件，存入、读出、修改、转储文件，控制文件的存取，安全控制，日志，压缩,加密等

支持的文件系统:

```bash
/lib/modules/`uname -r`/kernel/fs
```

各种文件系统：[https://wiki.deepin.org/wiki/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F](https://wiki.deepin.org/wiki/文件系统)

帮助：man 5 fs

### 2.2.2文件系统类型

```
#查看文件系统类型
df -T
```



**Linux常用文件系统**

<table>
    <tr>
    	<td>ext2</td>
        <td>Extended file system 适用于那些分区容量不是太大，更新也不频繁的情况，列如/boot 分区</td>
    </tr>
    <tr>
    	<td>ext3</td>
        <td>是ext2的改进版本，其支持日志功能，能够帮助系统从非正常关机导致的异常中恢复</td>
    </tr>
    <tr>
    	<td>ext4</td>
        <td>是ext文件系统的最新版，提供了很多新的特性，包括纳秒级时间戳、创建和使用巨型文件（16TB），最大1EB的文件系统，以及速度的提升</td>
    </tr>
    <tr>
    	<td>xfs</td>
        <td>SGI，支持最大8EB的文件系统</td>
    </tr>
    <tr>
    	<td>swap</td>
        <td>交换分区，虚拟内存</td>
    </tr>
    <tr>
    	<td>iso9660</td>
        <td>光盘</td>
    </tr>
    <tr>
    	<td>btrfs</td>
        <td>Oracle</td>
    </tr>
    <tr>
    	<td>relserfs</td>
        <td></td>
    </tr>
</table>

**Windows 常用文件系统**

<table>
    <tr>
    	<td>FAT32</td>
        <td></td>
    </tr>
    <tr>
    	<td>NTFS</td>
        <td></td>
    </tr>
    <tr>
    	<td>exFAT</td>
        <td></td>
    </tr>
</table>

**Unix**

<table>
    <tr>
    	<td>FFS</td>
        <td>fast</td>
    </tr>
    <tr>
    	<td>UFS</td>
        <td>unix</td>
    </tr>
    <tr>
    	<td>IFS2</td>
        <td></td>
    </tr>
</table>

**网络文件系统**

<table>
    <tr>
    	<td>NFS</td>
        <td></td>
    </tr>
    <tr>
    	<td>CIFS</td>
        <td></td>
    </tr>
</table>

**集群文件系统**

<table>
    <tr>
    	<td>GFS2</td>
        <td></td>
    </tr>
    <tr>
    	<td>OCFS2</td>
        <td>Oracle</td>
    </tr>
</table>

**分布式文件系统**

<table>
    <tr>
    	<td>fastdfs</td>
        <td></td>
    </tr>
    <tr>
    	<td>ceph</td>
        <td></td>
    </tr>
    <tr>
    	<td>moosefs</td>
        <td></td>
    </tr>
    <tr>
    	<td>mogilefs</td>
        <td></td>
    </tr>
    <tr>
    	<td>glusterfs</td>
        <td></td>
    </tr>
    <tr>
    	<td>Lustre</td>
        <td></td>
    </tr>
</table>

**RAW**

​	未经处理，或者未经格式化产生的文件系统

**常用的文件系统特性**

<table>
    <tr>
    	<td>FAT32</td>
        <td>最多只能支持16TB的文件系统和4GB的文件</td>
    </tr>
    <tr>
    	<td>NTFS</td>
        <td>最多只能支持16EB的文件系统和16EB的文件</td>
    </tr>
    <tr>
    	<td>EXT3</td>
        <td>1.最多只能支持32TB的文件系统和2TB的文件，实际只能容纳2TB的文件系统和16GB的文件<br>
        2.Ext3目前只支持32000个子目录<br>
        3.Ext3文件系统使用32位空间记录块数量和inode数量<br>
        4.当数据写入到Ext3文件系统中时，Ext3的数据块分配器每次只能分配一个4KB的块    
        </td>
    </tr>
    <tr>
    	<td>EXT4</td>
        <td>1.EXT4是Linux系统下的日志文件系统，是EXT3文件系统的后继版本<br>
        2.EXT4的文件系统容量达到1EB，而支持单个文件则达到16TB<br>
        3.理论上支持无限数量的子目录<br>
        4.EXT4文件系统使用64位空间记录块数量和inode数量<br>
        5.EXT4的多块分配器支持一次调用分配多个数据块
        <br>
        6.修复速度更快    
        </td>
    </tr>
    <tr>
    	<td>XFS</td>
        <td>1.根据所记录的日志在很短的时间内迅速恢复磁盘文件内容<br>
        2.用优化算法，日志记录对整体文件操作影响非常小
        <br>3.是一个全64-bit的文件系统，最大可以支持8EB的文件系统，而支持单个文件则达到8EB
        <br>4.能以接近裸设备I/O的性能存储数据</td>
    </tr>
</table>

目前支持的文件系统：

```bash
cat /proc/filesystems
```



### 2.2.3 文件系统的组成部分

```bash
#查看已经加载在内存中的文件系统
lsmod
```



+ 内核中的模块：ext4，xfs，vfat
+ Linux的虚拟文件系统：VFS
+ 用户矿建的管理工具：mkfs.ext4, mkfs.xfs, mkfs.vfat

![1585101527020](C:\Users\msi\AppData\Roaming\Typora\typora-user-images\1585101527020.png)



### 2.2.4 文件系统选择管理

#### 2.2.4.1 创建文件系统

**创建文件管理工具**

<table>
    <tr>
        <td rowspan="2">mkfs命令</td>
        <td>mkfs.FS_TYPE/dev/DEVICE
        <br>ext4
        <br>xfs
        <br>btrfs
        <br>vfat</td>
    </tr>
    <tr>
        <td>mkfs -t FS_TYPE /dev/DEVICE
        <br>-L 'LABEL' 设定卷标</td>
    </tr>
    <tr>
    	<td>mke2fs</td>
        <td>ext系列文件系统专用管理工具</td>
    </tr>
</table>

**常用选项**

<table style="width:100%">
    <tr>
    	<td style="width:45%;">-t {ext2|ext3|ext4}</td>
        <td>指定文件系统类型</td>
    </tr>
     <tr>
    	<td>-b {1024|2048|4096}</td>
        <td>指定块大小</td>
    </tr>
     <tr>
    	<td>-L 'LABEL'</td>
        <td>设置卷标</td>
    </tr>
     <tr>
    	<td>-j</td>
        <td>相当于 -t ext3，mkfs.ext3 = mkfs -t ext3 = mke2fs -j = mke2fs -t ext3</td>
    </tr>
     <tr>
    	<td>-i #</td>
        <td>为数据空间中每多少个字节创建一个inode；不应该小于block大小</td>
    </tr>
     <tr>
    	<td>-N #</td>
        <td>指定分区中创建多少个inode</td>
    </tr>
     <tr>
    	<td>-l</td>
        <td>一个inode记录占用的磁盘空间大小，128...4096</td>
    </tr>
     <tr>
    	<td>-m #</td>
        <td>默认5%，为管理人员预留空间占总空间的百分比</td>
    </tr>
     <tr>
    	<td>-O FEATURE[.....]</td>
        <td>启用指定特性</td>
    </tr>
    <tr>
    	<td>-O ^FEATURE[.....]</td>
        <td>关闭指定特性</td>
    </tr>
</table>



#### 2.2.4.2 查看和管理分区信息

```bash
#查看块设备属性信息

#格式
blkid [OPTION]...[DEVICE]
```

<table>
    <tr>
    	<td>查看块设备属性信息</td>
        <td>blkid</td>
    </tr>
    <tr>
    	<td>常用选项</td>
        <td>-U UUID	根据指定的UUID来查找对应的设备</td>
    </tr>
     <tr>
    	<td></td>
        <td>
         -L LABEL	根据指定的LABEL来查找对应的设备   	
         </td>
    </tr>
    <tr>
    	<td></td>
        <td>
         -L LABEL	根据指定的LABEL来查找对应的设备   	
         </td>
    </tr>
      <tr>
    	<td></td>
        <td>
        e2label:	管理ext系列文件系统的LABEL   
         </td>
    </tr>
</table>

