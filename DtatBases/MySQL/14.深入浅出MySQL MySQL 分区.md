# MySQL 分区

​		MySQL 从5.1 版本起开始支持分区功能。分区是指根据一定的规则，数据库把一个表分解成多个更小的、更容易管理的部分。就访问数据库的应用而言，逻辑上只有一个表或一个索引，但是实际上这个表可能有数十个物理分区对象组成，每个分区都是一个独立的对象，可以独自处理，可以作为表的一部分进行处理。分区对应用来说是完全透明的，不影响应用的业务逻辑。

## 分区概述

​		分区有利于管理非常大的表，它采用了“分而治之” 的逻辑。分区引入了分区键（Partition Key）的概念，分区键用于根据某个区间值（或者范围值）、特定值列表或者hash 函数值执行数据的聚集，让数据根据规则分布在不同的分区中，让一个大对象变成一些小对象。

​		MySQL 分区的优点主要包括以下 4 个方面：

1. 和单个磁盘或者文件系统分区相比，可以存储更多的数据。
2. 优化查询。在where 子句中包含分区条件时，可以只扫描必要的一个或多个分区来提高查询效率；同时在涉及 SUM() 和 COUNT() 这类聚合函数的查询时，可以容易地在每个分区上并行处理，最终只需要汇总所有地分区得到的结果。在MySQL 5.7 之中，还可以通过类似地 SELECT * FROM t PARTITION(p0,p1) 这样的方式来显示查询指定分区的数据。
3. 对于已经过期地或者不需要保存地数据，可以通过删除与这些数据有关的分区来快速删除数据。
4. 跨多个磁盘来分散数据查询，以获得更大的查询吞吐量。



​		在MySQL 5.7 中，通过二进制安装会默认包含分区支持，如果通过源码编译安装，那么需要在编译时指定参数 DWITH_PARTITION_STORAGE_ENGINE。

​		可以通过 SHOW PLUGINS 命令或者查询 PLUGINS 字典表来确定当前的 MySQL 是否支持分区，例如：

```mysql
mysql> show plugins;
...
partition                  | ACTIVE   | STORAGE ENGINE     | NULL    | GPL     |
```

​		MySQL支持大部分存储引擎（比如 MyISAM、InnoDB、Memory等）来创建分区表；但不支持MERGE、CVS和FEDERATED 这3类存储引擎。在MySQL 5.7 版本中，同一个分区表的所有分区必须使用同一个存储引擎，且分区数量不能超过 8192（NDB 存储引擎除外），即同一个表上，不能对一个分区使用MyISAM引擎，对另一个分区使用InnoDB。但是，可以在同一个MySQL服务器中，甚至同一个数据库中，对于不同的分区表使用不同的存储引擎。

​		和非分区设置存储引擎一样，分区表设置存储引擎，只能用 [STORAGE] ENGINE 子句。[STORAGE] ENGINE 子句必须列在 CREATE TABLE语句中的其他任何分区选项之前。例如，下面的例子创建了一个使用InnoDB 引擎并有6个HASH 分区的表：

```mysql

```

