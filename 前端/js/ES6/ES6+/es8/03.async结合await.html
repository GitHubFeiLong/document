<!DOCTYPE html>
<html lang="zh_CN">
<head>
    <meta charset="UTF-8">
    <title>async结合await</title>
</head>

<body>

</body>
<script>
    // 发送ajax亲求，返回Promise对象
    function sendAjax (url) {
        return new Promise((resolve, reject) => {
            // 1. 创建对象
        const x = new XMLHttpRequest();
        // 2. 初始化
        x.open('GET', url);
        // 3. 发送
        x.send();
        // 事件绑定
        x.onreadystatechange = function () {
            if (x.readyState === 4) {
                if (x.status >= 200 && x.status < 300) {
                    resolve(x.response)
                } else {
                    reject(x.status)
                }

            }
        }
        })
    }

    // Promise 和 then 测试
    // sendAjax('https://api.apiopen.top/getJoke').then(value => {
    //     console.log(value);
    // }, reason => {
    //     console.error(reason);
    // })

    // async 与 await 测试
    async function main () {
        let result = await sendAjax('https://api.apiopen.top/getJoke')
        console.log(result);
    }

    main()
</script>
</html>